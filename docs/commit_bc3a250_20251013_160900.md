# Documentation for Commit bc3a250

**Commit Hash:** bc3a250255c8517d0067de555ff2ed849ffd1a24
**Commit Message:** refactor(cli): Improve model selection and logging for generate command
**Generated:** Mon Oct 13 16:09:29 EDT 2025
**Repository:** CommitLM

---

This documentation details the recent changes to the `commitlm` CLI, focusing on improved transparency and user feedback regarding LLM model selection.

---

## `commitlm` CLI: Enhanced Model Selection and User Feedback

### 1. Summary

This update significantly enhances the `commitlm` CLI by improving transparency regarding the Large Language Model (LLM) provider and model used for generation tasks. It refines the model selection logic to correctly prioritize task-specific configurations and provides clearer, more accurate feedback to the user, especially when `commitlm` is integrated into Git hooks. A minor cosmetic change was also applied to the `status` command output for improved readability.

### 2. Changes

1.  **Enhanced Model Selection Logic:**
    *   The `generate` command now explicitly determines the *actual* LLM provider and model being used for both commit message generation and documentation generation. This logic correctly accounts for task-specific overrides defined in `settings.commit_message` or `settings.doc_generation` within your configuration, falling back to global `runtime_settings` if no task-specific override is present.
    *   Previously, the displayed provider/model might not have accurately reflected these task-specific overrides.

2.  **Improved Feedback for Commit Message Generation (Git Hooks):**
    *   When generating a short commit message (e.g., via `commitlm generate --short` for a Git `prepare-commit-msg` hook), informational messages (such as `CommitLM: generate commit message` and `Using provider: X, model: Y`) are now printed to `sys.stderr`.
    *   This crucial change ensures that these helpful messages are visible to the user in their terminal without being captured as part of the actual commit message, which is printed to `sys.stdout`.

3.  **Accurate Feedback for Documentation Generation:**
    *   The console output for documentation generation (`commitlm generate`) now consistently displays the *actual* provider and model selected after applying any task-specific overrides, ensuring consistency with the new model selection logic.

4.  **Minor `status` Command Formatting:**
    *   The `status` command's output for "Documentation Model" has been slightly refactored for conciseness, consolidating a multi-line `add_row` call into a single line. This is a cosmetic change with no functional impact.

### 3. Impact

*   **Improved User Experience:** Developers will now have a clearer and more accurate understanding of which LLM configuration is active for specific generation tasks, reducing ambiguity.
*   **Enhanced Git Hook Integration:** The separation of informational output to `stderr` prevents unwanted text from appearing in generated commit messages when `commitlm` is used in Git hooks, streamlining the automated workflow.
*   **Configuration Clarity:** The refined model selection logic ensures that task-specific provider/model settings are correctly applied and accurately reflected in user feedback.

### 4. Usage

No changes to command-line usage are required. The new informational messages will appear automatically:

*   **For Git Hooks (e.g., `prepare-commit-msg`):**
    When `commitlm generate --short` is invoked, you will now see a header and model information printed to your terminal's error stream (stderr):
    ```bash
    # Example output when commitlm is run via a Git hook:
    # CommitLM: generate commit message
    # Using provider: openai, model: gpt-4-turbo
    # (The actual commit message will then be written to the commit message file)
    ```

*   **For Documentation Generation:**
    The console output for `commitlm generate` will now accurately reflect any overridden provider/model settings:
    ```bash
    commitlm generate
    # Example output:
    # Using provider: anthropic, model: claude-3-opus-20240229
    ```

### 5. Breaking Changes

None. This update is fully backward compatible.

### 6. Migration Notes

No migration steps are required. Users will automatically benefit from these enhancements upon updating `commitlm`.